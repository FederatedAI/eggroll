import{d as K,r as C,n as c,o as j,b as p,e as H,f,i as e,j as a,Q as m,W as $,c as Q,k as d,X,T,R as q,_ as G}from"./index-e87360db.js";import{d as J}from"./dialogTable-93e56230.js";const Z={class:"section"},ee={class:"section-table"},te={class:"form-table"},ae={class:"action-btn"},oe={class:"table"},le={class:"flex-page"},se=K({__name:"index",setup(ne){const o=C({sessionId:"",status:"",createTime:""});function V(l){return!["PREPARE","NEW","ACTIVE"].includes(l.status)}const x=c([]),r=C({page:1,pageSize:20}),I=c(1),S=c(20),E=c(0);function R(l){r.pageSize=l,_()}function k(l){r.page=l,_()}function P(){r.page=1,r.pageSize=20,_()}function y(l){X({sessionId:l.sessionId}).then(t=>{t.code===0?(T.success(t.msg||t.data),_()):T.success(t.msg)})}const z=c("Processor List"),h=c(!1),w=c([]),D=[{prop:"processorId",label:"ProcessorId",width:"120px"},{prop:"sessionId",label:"SessionId",width:"300px"},{prop:"serverNodeId",label:"ServerNodeId",width:"140px"},{prop:"processorType",label:"Type",width:"120px"},{prop:"status",label:"Status",width:"110px"},{prop:"commandEndpoint",label:"CommandEndPoint",width:"180px"},{prop:"transferEndpoint",label:"TransferEndPoint",width:"170px"},{prop:"pid",label:"Pid"},{prop:"updatedAt",label:"UpdatedAt",width:"170px"},{prop:"processorOption",label:"ProcessorOption",width:"400px"}];let b="";function A(l){h.value=!0,b=typeof l=="string"?b:l.row.sessionId,q({sessionId:b}).then(t=>{t.code===0&&(w.value=t.data.map(s=>(s.updatedAt=m(s.updatedAt),s.createdAt=m(s.createdAt),s)))})}function N(){A(b)}function U(){h.value=!1}function L(){r.page=1,r.pageSize=15,o.createTime="",o.sessionId="",o.status="",_()}function _(){let l={pageNum:r.page,pageSize:r.pageSize,sessionId:o.sessionId,status:o.status,createdAt:o.createTime?m(o.createTime,"YYYY-MM-DD"):""};$(l).then(t=>{t.code===0&&(E.value=t.total,x.value=t.data.map(s=>(s.updatedAt=m(s.updatedAt),s.createdAt=m(s.createdAt),s)))})}return j(()=>{_()}),(l,t)=>{const s=p("el-input"),v=p("el-form-item"),u=p("el-option"),M=p("el-select"),O=p("el-date-picker"),g=p("el-button"),W=p("el-form"),i=p("el-table-column"),B=p("el-table"),Y=p("el-pagination");return Q(),H("div",Z,[f("div",ee,[f("div",te,[e(W,{model:o,class:"search-from"},{default:a(()=>[e(v,{label:"Session ID:",class:"input-width"},{default:a(()=>[e(s,{placeholder:"select session id",modelValue:o.sessionId,"onUpdate:modelValue":t[0]||(t[0]=n=>o.sessionId=n),modelModifiers:{trim:!0},clearable:""},null,8,["modelValue"])]),_:1}),e(v,{label:"Status:"},{default:a(()=>[e(M,{placeholder:"select status",modelValue:o.status,"onUpdate:modelValue":t[1]||(t[1]=n=>o.status=n),clearable:"",filterable:""},{default:a(()=>[e(u,{value:"NEW"},{default:a(()=>[d("NEW")]),_:1}),e(u,{value:"NEW_TIMEOUT"},{default:a(()=>[d("NEW_TIMEOUT")]),_:1}),e(u,{value:"ACTIVE"},{default:a(()=>[d("ACTIVE")]),_:1}),e(u,{value:"CLOSED"},{default:a(()=>[d("CLOSED")]),_:1}),e(u,{value:"KILLED"},{default:a(()=>[d("KILLED")]),_:1}),e(u,{value:"ERROR"},{default:a(()=>[d("ERROR")]),_:1}),e(u,{value:"FINISHED"},{default:a(()=>[d("FINISHED")]),_:1}),e(u,{value:"PREPARE"},{default:a(()=>[d("PREPARE")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"CreatedAt:"},{default:a(()=>[e(O,{placeholder:"select createdAt",modelValue:o.createTime,"onUpdate:modelValue":t[2]||(t[2]=n=>o.createTime=n),type:"date",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),f("div",ae,[e(g,{type:"primary",onClick:P},{default:a(()=>[d("Search")]),_:1}),e(g,{type:"primary",onClick:L},{default:a(()=>[d("Refresh")]),_:1})])]),_:1},8,["model"]),f("div",oe,[e(B,{data:x.value,"max-height":"750px"},{default:a(()=>[e(i,{prop:"sessionId","show-overflow-tooltip":"",label:"Session Id",fixed:"left",width:"300px"}),e(i,{prop:"name",label:"Name",width:"110px"}),e(i,{prop:"totalProcCount",label:"Total"}),e(i,{prop:"activeProcCount",label:"ActionTotal",width:"130px"}),e(i,{prop:"status",label:"Status","show-overflow-tooltip":"",width:"120px"}),e(i,{prop:"beforeStatus",label:"BeforeStatus",width:"130px"}),e(i,{prop:"statusReason",label:"StatusReason",width:"140px"}),e(i,{prop:"createdAt",label:"CreatedAt",width:"180px"}),e(i,{prop:"updatedAt",label:"UpdatedAt",width:"180px"}),e(i,{fixed:"right",label:"Action",width:"180"},{default:a(n=>[e(g,{link:"",type:"primary",onClick:F=>A(n)},{default:a(()=>[d("processor信息")]),_:2},1032,["onClick"]),e(g,{link:"",type:"primary",disabled:V(n.row),onClick:F=>y(n.row)},{default:a(()=>[d("kill")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"]),f("div",le,[e(Y,{class:"pt-16",background:"",layout:"total, sizes, prev, pager, next, jumper","current-age":I.value,"onUpdate:currentAge":t[3]||(t[3]=n=>I.value=n),"page-size":S.value,"onUpdate:pageSize":t[4]||(t[4]=n=>S.value=n),"page-sizes":[10,20,30,50],total:E.value,onSizeChange:R,onCurrentChange:k},null,8,["current-age","page-size","total"])])])])]),e(J,{title:z.value,dialogVisible:h.value,tableData:w.value,tableLabel:D,onUpdateVisiable:U,onRefresh:N},null,8,["title","dialogVisible","tableData"])])}}});const pe=G(se,[["__scopeId","data-v-4d7fa935"]]);export{pe as default};
